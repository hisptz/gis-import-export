/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import { Component } from '@angular/core';
import { trigger, state, style, transition, animate } from '@angular/animations';
import { MenuService } from '../../services/menu.service';
import { SystemStateService } from '../../services/system-state.service';
import { MENU_BACKGROUND_COLORS } from '../../constants/menu-background-colors';
export class MenuComponent {
    /**
     * @param {?} menuService
     * @param {?} systemStatusService
     */
    constructor(menuService, systemStatusService) {
        this.menuService = menuService;
        this.systemStatusService = systemStatusService;
        this.rootUrl = '../../../';
        this.menuLoading = true;
        this.menuLoadingFail = false;
        this.loggedIn$ = this.systemStatusService.getLoginStatus();
        this.online = false;
        this.menuNotification = '';
        this.wasOffline = true;
        this.backgroundColor = '#ECECEC';
        this.showSidebar = false;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.systemStatusService.checkOnlineStatus().subscribe((onlineStatus) => {
            this.online = onlineStatus;
            if (this.online && this.wasOffline) {
                this.menuNotification = 'You are online';
                this.wasOffline = false;
                /**
                         * Hide notification status after sometimes
                         */
                setTimeout(() => {
                    this.menuNotification = '';
                }, 3000);
                /**
                         * Load system settings if failed
                         */
                if (this.menuLoadingFail) {
                    this.menuLoading = true;
                    this.getSystemSettings();
                }
            }
            else if (!this.online) {
                this.menuNotification = 'You are offline';
                this.wasOffline = true;
            }
        });
        this.getSystemSettings();
    }
    /**
     * @param {?} e
     * @return {?}
     */
    toggleSideBar(e) {
        e.stopPropagation();
        this.showSidebar = !this.showSidebar;
    }
    /**
     * @return {?}
     */
    getSystemSettings() {
        this.menuService.getSystemSettings(this.rootUrl).subscribe((settings) => {
            if (settings) {
                this.applicationTitle = settings['applicationTitle'];
                // get system current background style
                const /** @type {?} */ colorName = settings.hasOwnProperty('currentStyle')
                    ? settings['currentStyle'].split('/')[0]
                    : settings.hasOwnProperty('keyStyle')
                        ? settings['keyStyle'].split('/')[0]
                        : 'blue';
                this.backgroundColor =
                    MENU_BACKGROUND_COLORS[colorName];
                this.contextPath = settings.contextPath ? settings.contextPath + '/' : '';
            }
            this.menuLoading = false;
            this.menuLoadingFail = false;
        }, () => {
            this.menuLoading = false;
            this.menuLoadingFail = true;
        });
    }
}
MenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-dhis2-menu',
                template: `<div class="menu-container">

  <!-- notification area -->
  <div class="menu-notification-area" *ngIf="menuNotification !== ''" [@open]>
    {{ menuNotification }}
  </div>
  <!-- end of notification area -->
  <!-- login form area -->
  <div class="login-form-container" *ngIf="!(loggedIn$ | async)">
    <app-login-form></app-login-form>
  </div>
  <!-- end of login form area -->

  <!--menu loading area-->
  <div class="menu-loader" *ngIf="menuLoading">
    <app-menu-loader></app-menu-loader>
  </div>
  <!--end of menu loading area-->

  <!--menu loading failed area-->
  <div class="menu-content" *ngIf="!menuLoading && menuLoadingFail" style="background-color: #eeeeee">
    &nbsp;
  </div>
  <!--end of menu loading failed area-->

  <!--menu content area-->
  <div class="menu-content" [style.background-color]="backgroundColor" *ngIf="!menuLoading && !menuLoadingFail">
    <!--menu left block-->
    <div class="menu-left-block">

      <!--menu brand area-->
      <div class="menu-brand">
        <a [href]="rootUrl + 'dhis-web-commons-about/redirect.action'">
          <img [src]="rootUrl + 'api/staticContent/logo_banner'" alt="">
        </a>
      </div>
      <!--end of menu brand area-->

      <!--menu title area-->
      <div class="menu-title-block">
        <a [href]="rootUrl + 'dhis-web-commons-about/redirect.action'" class="menu-title">
          {{applicationTitle}}
        </a>
      </div>
      <!--end of menu title area-->
    </div>
    <!--end of menu left block-->

    <!--menu right block-->
    <div class="menu-right-block">
      <div class="menu-notification-block">
        <app-menu-notification [rootUrl]="rootUrl"></app-menu-notification>
      </div>
      <!--menu search block-->
      <div class="menu-search-block">
        <app-menu-search></app-menu-search>
      </div>
      <!--end of menu search block-->

      <!--menu profile block-->
      <div class="menu-profile-block">
        <app-menu-profile [rootUrl]="rootUrl" [contextPath]="contextPath" [backgroundColor]="backgroundColor"></app-menu-profile>
      </div>
      <!--end of menu profile block-->

      <!--menu sidebar toggle button-->
      <div
        class="menu-toggle-button"
      >
        <a
          (click)="toggleSideBar($event)"
        >
          <svg
            class="menu-toggle-icon"
            viewBox="0 0 24 24"
          >
            <path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"></path>
          </svg>
        </a>
      </div>
      <!--end of menu sidebar toggle button-->

      <!--sidebar menu block-->
      <div class="sidebar-menu-nav" *ngIf="showSidebar">
        <app-menu-side-bar></app-menu-side-bar>
      </div>
      <!--end of sidebar menu block-->
      <div></div>
    </div>
    <!--end of menu right block-->
  </div>
  <!--end of menu content area-->
</div>
`,
                styles: [`.menu-container{position:fixed;left:0;top:0;right:0;z-index:1400;height:48px}.menu-loader{height:100%}.menu-content{display:flex;width:100%;height:100%;justify-content:space-between}.menu-left-block,.menu-right-block{display:flex}.menu-brand{width:155px;height:100%;display:flex;justify-content:center;align-items:center}.menu-brand>a>img{display:block;margin:auto;max-height:44px;max-width:155px}.menu-title-block{overflow:hidden;white-space:nowrap;color:#fff;align-items:center;justify-items:center;display:flex;padding-right:1rem}.menu-title{font-size:1rem;font-weight:700;color:#fff;text-decoration:none;text-overflow:ellipsis;min-width:1px;overflow:hidden;white-space:nowrap}.menu-search-block{height:100%}.login-form-container{position:fixed;z-index:1500;top:2px;left:20%;min-height:42px;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px}.menu-notification-area{position:fixed;z-index:1500;top:7px;left:20%;height:auto;border-color:#f0c36d;background-color:#f9edbe;border-radius:3px;padding:5px;font-size:15px}.menu-toggle-button{display:none;flex-direction:row;justify-content:flex-end;padding-right:10px;padding-top:6px}.menu-toggle-icon{display:inline-block;height:35px;width:35px;fill:#fff}.sidebar-menu-nav{position:absolute;top:100%;width:400px;height:100vh;right:0;z-index:900;font-size:14px;text-align:left;list-style:none;background-color:#fff;-webkit-background-clip:padding-box;transition:width .5s cubic-bezier(.39,-.04,.2,1);background-clip:padding-box;box-shadow:0 6px 12px rgba(0,0,0,.175)}@media (max-width:400px){.sidebar-menu-nav{width:95%}}@media (max-width:500px){.login-form-container{top:50px;left:2%;width:96%;height:auto}.menu-notification-area{left:2%;right:2%;width:96%;height:auto}}@media (max-width:999px){.menu-profile-block,.menu-search-block,.menu-title-block{display:none}.menu-brand{justify-content:flex-start;margin-left:15px}.menu-toggle-button{display:flex}}.menu-notification-block{display:flex;align-items:center;height:100%;margin-right:30px}@media (min-width:1010px){.sidebar-menu-nav{display:none!important}}`],
                animations: [
                    trigger('open', [
                        state('in', style({
                            opacity: 1
                        })),
                        transition('void => *', [
                            style({
                                opacity: 0
                            }),
                            animate(700)
                        ]),
                        transition('* => void', [
                            animate(400),
                            style({
                                opacity: 0
                            })
                        ])
                    ])
                ]
            },] },
];
/** @nocollapse */
MenuComponent.ctorParameters = () => [
    { type: MenuService },
    { type: SystemStateService }
];
function MenuComponent_tsickle_Closure_declarations() {
    /** @type {?} */
    MenuComponent.prototype.rootUrl;
    /** @type {?} */
    MenuComponent.prototype.applicationTitle;
    /** @type {?} */
    MenuComponent.prototype.backgroundColor;
    /** @type {?} */
    MenuComponent.prototype.menuLoading;
    /** @type {?} */
    MenuComponent.prototype.menuLoadingFail;
    /** @type {?} */
    MenuComponent.prototype.loggedIn$;
    /** @type {?} */
    MenuComponent.prototype.online;
    /** @type {?} */
    MenuComponent.prototype.menuNotification;
    /** @type {?} */
    MenuComponent.prototype.wasOffline;
    /** @type {?} */
    MenuComponent.prototype.showSidebar;
    /** @type {?} */
    MenuComponent.prototype.contextPath;
    /** @type {?} */
    MenuComponent.prototype.menuService;
    /** @type {?} */
    MenuComponent.prototype.systemStatusService;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AaGlzcHR6L25neC1kaGlzMi1tZW51LyIsInNvdXJjZXMiOlsibGliL2NvbnRhaW5lcnMvbWVudS9tZW51LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUNsRCxPQUFPLEVBQ0wsT0FBTyxFQUNQLEtBQUssRUFDTCxLQUFLLEVBQ0wsVUFBVSxFQUNWLE9BQU8sRUFDUixNQUFNLHFCQUFxQixDQUFDO0FBRTdCLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUN6RSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQTBIaEYsTUFBTTs7Ozs7SUFhSixZQUFvQixXQUF3QixFQUNsQztRQURVLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBQ2xDLHdCQUFtQixHQUFuQixtQkFBbUI7UUFDM0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxXQUFXLENBQUM7UUFDM0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7UUFDeEIsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7UUFDN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDM0QsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDcEIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEVBQUUsQ0FBQztRQUMzQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztRQUN2QixJQUFJLENBQUMsZUFBZSxHQUFHLFNBQVMsQ0FBQztRQUNqQyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztLQUMxQjs7OztJQUVELFFBQVE7UUFDTixJQUFJLENBQUMsbUJBQW1CLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxZQUFZLEVBQUUsRUFBRTtZQUN0RSxJQUFJLENBQUMsTUFBTSxHQUFHLFlBQVksQ0FBQztZQUMzQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUNuQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7Z0JBQ3pDLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDOzs7O2dCQUt4QixVQUFVLENBQUMsR0FBRyxFQUFFO29CQUNkLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUM7aUJBQzVCLEVBQUUsSUFBSSxDQUFDLENBQUM7Ozs7Z0JBS1QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7b0JBQ3pCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO29CQUN4QixJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztpQkFDMUI7YUFFRjtZQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUN4QixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsaUJBQWlCLENBQUM7Z0JBQzFDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO2FBQ3hCO1NBQ0YsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7S0FDMUI7Ozs7O0lBRUQsYUFBYSxDQUFDLENBQUM7UUFDYixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7S0FDdEM7Ozs7SUFFRCxpQkFBaUI7UUFDZixJQUFJLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQ3hELENBQUMsUUFBYSxFQUFFLEVBQUU7WUFDaEIsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztnQkFDYixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLGtCQUFrQixDQUFDLENBQUM7O2dCQUdyRCx1QkFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUM7b0JBQ3ZELENBQUMsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDeEMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDO3dCQUNuQyxDQUFDLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQ3BDLENBQUMsQ0FBQyxNQUFNLENBQUM7Z0JBQ2IsSUFBSSxDQUFDLGVBQWU7b0JBQ2xCLHNCQUFzQixDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUVwQyxJQUFJLENBQUMsV0FBVyxHQUFHLFFBQVEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7YUFDM0U7WUFDRCxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztZQUN6QixJQUFJLENBQUMsZUFBZSxHQUFHLEtBQUssQ0FBQztTQUM5QixFQUNELEdBQUcsRUFBRTtZQUNILElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDO1NBQzdCLENBQ0YsQ0FBQztLQUNIOzs7WUE5TUYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxnQkFBZ0I7Z0JBQzFCLFFBQVEsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0NBNkZYO2dCQUNDLE1BQU0sRUFBRSxDQUFDLHVoRUFBdWhFLENBQUM7Z0JBQ2ppRSxVQUFVLEVBQUU7b0JBQ1YsT0FBTyxDQUFDLE1BQU0sRUFBRTt3QkFDZCxLQUFLLENBQ0gsSUFBSSxFQUNKLEtBQUssQ0FBQzs0QkFDSixPQUFPLEVBQUUsQ0FBQzt5QkFDWCxDQUFDLENBQ0g7d0JBQ0QsVUFBVSxDQUFDLFdBQVcsRUFBRTs0QkFDdEIsS0FBSyxDQUFDO2dDQUNKLE9BQU8sRUFBRSxDQUFDOzZCQUNYLENBQUM7NEJBQ0YsT0FBTyxDQUFDLEdBQUcsQ0FBQzt5QkFDYixDQUFDO3dCQUNGLFVBQVUsQ0FBQyxXQUFXLEVBQUU7NEJBQ3RCLE9BQU8sQ0FBQyxHQUFHLENBQUM7NEJBQ1osS0FBSyxDQUFDO2dDQUNKLE9BQU8sRUFBRSxDQUFDOzZCQUNYLENBQUM7eUJBQ0gsQ0FBQztxQkFDSCxDQUFDO2lCQUNIO2FBQ0Y7Ozs7WUEzSFEsV0FBVztZQUNYLGtCQUFrQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICB0cmlnZ2VyLFxuICBzdGF0ZSxcbiAgc3R5bGUsXG4gIHRyYW5zaXRpb24sXG4gIGFuaW1hdGVcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBNZW51U2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21lbnUuc2VydmljZSc7XG5pbXBvcnQgeyBTeXN0ZW1TdGF0ZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zeXN0ZW0tc3RhdGUuc2VydmljZSc7XG5pbXBvcnQgeyBNRU5VX0JBQ0tHUk9VTkRfQ09MT1JTIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL21lbnUtYmFja2dyb3VuZC1jb2xvcnMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtZGhpczItbWVudScsXG4gIHRlbXBsYXRlOiBgPGRpdiBjbGFzcz1cIm1lbnUtY29udGFpbmVyXCI+XG5cbiAgPCEtLSBub3RpZmljYXRpb24gYXJlYSAtLT5cbiAgPGRpdiBjbGFzcz1cIm1lbnUtbm90aWZpY2F0aW9uLWFyZWFcIiAqbmdJZj1cIm1lbnVOb3RpZmljYXRpb24gIT09ICcnXCIgW0BvcGVuXT5cbiAgICB7eyBtZW51Tm90aWZpY2F0aW9uIH19XG4gIDwvZGl2PlxuICA8IS0tIGVuZCBvZiBub3RpZmljYXRpb24gYXJlYSAtLT5cbiAgPCEtLSBsb2dpbiBmb3JtIGFyZWEgLS0+XG4gIDxkaXYgY2xhc3M9XCJsb2dpbi1mb3JtLWNvbnRhaW5lclwiICpuZ0lmPVwiIShsb2dnZWRJbiQgfCBhc3luYylcIj5cbiAgICA8YXBwLWxvZ2luLWZvcm0+PC9hcHAtbG9naW4tZm9ybT5cbiAgPC9kaXY+XG4gIDwhLS0gZW5kIG9mIGxvZ2luIGZvcm0gYXJlYSAtLT5cblxuICA8IS0tbWVudSBsb2FkaW5nIGFyZWEtLT5cbiAgPGRpdiBjbGFzcz1cIm1lbnUtbG9hZGVyXCIgKm5nSWY9XCJtZW51TG9hZGluZ1wiPlxuICAgIDxhcHAtbWVudS1sb2FkZXI+PC9hcHAtbWVudS1sb2FkZXI+XG4gIDwvZGl2PlxuICA8IS0tZW5kIG9mIG1lbnUgbG9hZGluZyBhcmVhLS0+XG5cbiAgPCEtLW1lbnUgbG9hZGluZyBmYWlsZWQgYXJlYS0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1jb250ZW50XCIgKm5nSWY9XCIhbWVudUxvYWRpbmcgJiYgbWVudUxvYWRpbmdGYWlsXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlZWVlXCI+XG4gICAgJm5ic3A7XG4gIDwvZGl2PlxuICA8IS0tZW5kIG9mIG1lbnUgbG9hZGluZyBmYWlsZWQgYXJlYS0tPlxuXG4gIDwhLS1tZW51IGNvbnRlbnQgYXJlYS0tPlxuICA8ZGl2IGNsYXNzPVwibWVudS1jb250ZW50XCIgW3N0eWxlLmJhY2tncm91bmQtY29sb3JdPVwiYmFja2dyb3VuZENvbG9yXCIgKm5nSWY9XCIhbWVudUxvYWRpbmcgJiYgIW1lbnVMb2FkaW5nRmFpbFwiPlxuICAgIDwhLS1tZW51IGxlZnQgYmxvY2stLT5cbiAgICA8ZGl2IGNsYXNzPVwibWVudS1sZWZ0LWJsb2NrXCI+XG5cbiAgICAgIDwhLS1tZW51IGJyYW5kIGFyZWEtLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LWJyYW5kXCI+XG4gICAgICAgIDxhIFtocmVmXT1cInJvb3RVcmwgKyAnZGhpcy13ZWItY29tbW9ucy1hYm91dC9yZWRpcmVjdC5hY3Rpb24nXCI+XG4gICAgICAgICAgPGltZyBbc3JjXT1cInJvb3RVcmwgKyAnYXBpL3N0YXRpY0NvbnRlbnQvbG9nb19iYW5uZXInXCIgYWx0PVwiXCI+XG4gICAgICAgIDwvYT5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBtZW51IGJyYW5kIGFyZWEtLT5cblxuICAgICAgPCEtLW1lbnUgdGl0bGUgYXJlYS0tPlxuICAgICAgPGRpdiBjbGFzcz1cIm1lbnUtdGl0bGUtYmxvY2tcIj5cbiAgICAgICAgPGEgW2hyZWZdPVwicm9vdFVybCArICdkaGlzLXdlYi1jb21tb25zLWFib3V0L3JlZGlyZWN0LmFjdGlvbidcIiBjbGFzcz1cIm1lbnUtdGl0bGVcIj5cbiAgICAgICAgICB7e2FwcGxpY2F0aW9uVGl0bGV9fVxuICAgICAgICA8L2E+XG4gICAgICA8L2Rpdj5cbiAgICAgIDwhLS1lbmQgb2YgbWVudSB0aXRsZSBhcmVhLS0+XG4gICAgPC9kaXY+XG4gICAgPCEtLWVuZCBvZiBtZW51IGxlZnQgYmxvY2stLT5cblxuICAgIDwhLS1tZW51IHJpZ2h0IGJsb2NrLS0+XG4gICAgPGRpdiBjbGFzcz1cIm1lbnUtcmlnaHQtYmxvY2tcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJtZW51LW5vdGlmaWNhdGlvbi1ibG9ja1wiPlxuICAgICAgICA8YXBwLW1lbnUtbm90aWZpY2F0aW9uIFtyb290VXJsXT1cInJvb3RVcmxcIj48L2FwcC1tZW51LW5vdGlmaWNhdGlvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLW1lbnUgc2VhcmNoIGJsb2NrLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwibWVudS1zZWFyY2gtYmxvY2tcIj5cbiAgICAgICAgPGFwcC1tZW51LXNlYXJjaD48L2FwcC1tZW51LXNlYXJjaD5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBtZW51IHNlYXJjaCBibG9jay0tPlxuXG4gICAgICA8IS0tbWVudSBwcm9maWxlIGJsb2NrLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwibWVudS1wcm9maWxlLWJsb2NrXCI+XG4gICAgICAgIDxhcHAtbWVudS1wcm9maWxlIFtyb290VXJsXT1cInJvb3RVcmxcIiBbY29udGV4dFBhdGhdPVwiY29udGV4dFBhdGhcIiBbYmFja2dyb3VuZENvbG9yXT1cImJhY2tncm91bmRDb2xvclwiPjwvYXBwLW1lbnUtcHJvZmlsZT5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBtZW51IHByb2ZpbGUgYmxvY2stLT5cblxuICAgICAgPCEtLW1lbnUgc2lkZWJhciB0b2dnbGUgYnV0dG9uLS0+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwibWVudS10b2dnbGUtYnV0dG9uXCJcbiAgICAgID5cbiAgICAgICAgPGFcbiAgICAgICAgICAoY2xpY2spPVwidG9nZ2xlU2lkZUJhcigkZXZlbnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxzdmdcbiAgICAgICAgICAgIGNsYXNzPVwibWVudS10b2dnbGUtaWNvblwiXG4gICAgICAgICAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8cGF0aCBkPVwiTTQgOGg0VjRINHY0em02IDEyaDR2LTRoLTR2NHptLTYgMGg0di00SDR2NHptMC02aDR2LTRINHY0em02IDBoNHYtNGgtNHY0em02LTEwdjRoNFY0aC00em0tNiA0aDRWNGgtNHY0em02IDZoNHYtNGgtNHY0em0wIDZoNHYtNGgtNHY0elwiPjwvcGF0aD5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgPC9hPlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tZW5kIG9mIG1lbnUgc2lkZWJhciB0b2dnbGUgYnV0dG9uLS0+XG5cbiAgICAgIDwhLS1zaWRlYmFyIG1lbnUgYmxvY2stLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJzaWRlYmFyLW1lbnUtbmF2XCIgKm5nSWY9XCJzaG93U2lkZWJhclwiPlxuICAgICAgICA8YXBwLW1lbnUtc2lkZS1iYXI+PC9hcHAtbWVudS1zaWRlLWJhcj5cbiAgICAgIDwvZGl2PlxuICAgICAgPCEtLWVuZCBvZiBzaWRlYmFyIG1lbnUgYmxvY2stLT5cbiAgICAgIDxkaXY+PC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPCEtLWVuZCBvZiBtZW51IHJpZ2h0IGJsb2NrLS0+XG4gIDwvZGl2PlxuICA8IS0tZW5kIG9mIG1lbnUgY29udGVudCBhcmVhLS0+XG48L2Rpdj5cbmAsXG4gIHN0eWxlczogW2AubWVudS1jb250YWluZXJ7cG9zaXRpb246Zml4ZWQ7bGVmdDowO3RvcDowO3JpZ2h0OjA7ei1pbmRleDoxNDAwO2hlaWdodDo0OHB4fS5tZW51LWxvYWRlcntoZWlnaHQ6MTAwJX0ubWVudS1jb250ZW50e2Rpc3BsYXk6ZmxleDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVufS5tZW51LWxlZnQtYmxvY2ssLm1lbnUtcmlnaHQtYmxvY2t7ZGlzcGxheTpmbGV4fS5tZW51LWJyYW5ke3dpZHRoOjE1NXB4O2hlaWdodDoxMDAlO2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2FsaWduLWl0ZW1zOmNlbnRlcn0ubWVudS1icmFuZD5hPmltZ3tkaXNwbGF5OmJsb2NrO21hcmdpbjphdXRvO21heC1oZWlnaHQ6NDRweDttYXgtd2lkdGg6MTU1cHh9Lm1lbnUtdGl0bGUtYmxvY2t7b3ZlcmZsb3c6aGlkZGVuO3doaXRlLXNwYWNlOm5vd3JhcDtjb2xvcjojZmZmO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWl0ZW1zOmNlbnRlcjtkaXNwbGF5OmZsZXg7cGFkZGluZy1yaWdodDoxcmVtfS5tZW51LXRpdGxle2ZvbnQtc2l6ZToxcmVtO2ZvbnQtd2VpZ2h0OjcwMDtjb2xvcjojZmZmO3RleHQtZGVjb3JhdGlvbjpub25lO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7bWluLXdpZHRoOjFweDtvdmVyZmxvdzpoaWRkZW47d2hpdGUtc3BhY2U6bm93cmFwfS5tZW51LXNlYXJjaC1ibG9ja3toZWlnaHQ6MTAwJX0ubG9naW4tZm9ybS1jb250YWluZXJ7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoxNTAwO3RvcDoycHg7bGVmdDoyMCU7bWluLWhlaWdodDo0MnB4O2JvcmRlci1jb2xvcjojZjBjMzZkO2JhY2tncm91bmQtY29sb3I6I2Y5ZWRiZTtib3JkZXItcmFkaXVzOjNweH0ubWVudS1ub3RpZmljYXRpb24tYXJlYXtwb3NpdGlvbjpmaXhlZDt6LWluZGV4OjE1MDA7dG9wOjdweDtsZWZ0OjIwJTtoZWlnaHQ6YXV0bztib3JkZXItY29sb3I6I2YwYzM2ZDtiYWNrZ3JvdW5kLWNvbG9yOiNmOWVkYmU7Ym9yZGVyLXJhZGl1czozcHg7cGFkZGluZzo1cHg7Zm9udC1zaXplOjE1cHh9Lm1lbnUtdG9nZ2xlLWJ1dHRvbntkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246cm93O2p1c3RpZnktY29udGVudDpmbGV4LWVuZDtwYWRkaW5nLXJpZ2h0OjEwcHg7cGFkZGluZy10b3A6NnB4fS5tZW51LXRvZ2dsZS1pY29ue2Rpc3BsYXk6aW5saW5lLWJsb2NrO2hlaWdodDozNXB4O3dpZHRoOjM1cHg7ZmlsbDojZmZmfS5zaWRlYmFyLW1lbnUtbmF2e3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxMDAlO3dpZHRoOjQwMHB4O2hlaWdodDoxMDB2aDtyaWdodDowO3otaW5kZXg6OTAwO2ZvbnQtc2l6ZToxNHB4O3RleHQtYWxpZ246bGVmdDtsaXN0LXN0eWxlOm5vbmU7YmFja2dyb3VuZC1jb2xvcjojZmZmOy13ZWJraXQtYmFja2dyb3VuZC1jbGlwOnBhZGRpbmctYm94O3RyYW5zaXRpb246d2lkdGggLjVzIGN1YmljLWJlemllciguMzksLS4wNCwuMiwxKTtiYWNrZ3JvdW5kLWNsaXA6cGFkZGluZy1ib3g7Ym94LXNoYWRvdzowIDZweCAxMnB4IHJnYmEoMCwwLDAsLjE3NSl9QG1lZGlhIChtYXgtd2lkdGg6NDAwcHgpey5zaWRlYmFyLW1lbnUtbmF2e3dpZHRoOjk1JX19QG1lZGlhIChtYXgtd2lkdGg6NTAwcHgpey5sb2dpbi1mb3JtLWNvbnRhaW5lcnt0b3A6NTBweDtsZWZ0OjIlO3dpZHRoOjk2JTtoZWlnaHQ6YXV0b30ubWVudS1ub3RpZmljYXRpb24tYXJlYXtsZWZ0OjIlO3JpZ2h0OjIlO3dpZHRoOjk2JTtoZWlnaHQ6YXV0b319QG1lZGlhIChtYXgtd2lkdGg6OTk5cHgpey5tZW51LXByb2ZpbGUtYmxvY2ssLm1lbnUtc2VhcmNoLWJsb2NrLC5tZW51LXRpdGxlLWJsb2Nre2Rpc3BsYXk6bm9uZX0ubWVudS1icmFuZHtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydDttYXJnaW4tbGVmdDoxNXB4fS5tZW51LXRvZ2dsZS1idXR0b257ZGlzcGxheTpmbGV4fX0ubWVudS1ub3RpZmljYXRpb24tYmxvY2t7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtoZWlnaHQ6MTAwJTttYXJnaW4tcmlnaHQ6MzBweH1AbWVkaWEgKG1pbi13aWR0aDoxMDEwcHgpey5zaWRlYmFyLW1lbnUtbmF2e2Rpc3BsYXk6bm9uZSFpbXBvcnRhbnR9fWBdLFxuICBhbmltYXRpb25zOiBbXG4gICAgdHJpZ2dlcignb3BlbicsIFtcbiAgICAgIHN0YXRlKFxuICAgICAgICAnaW4nLFxuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgb3BhY2l0eTogMVxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gKicsIFtcbiAgICAgICAgc3R5bGUoe1xuICAgICAgICAgIG9wYWNpdHk6IDBcbiAgICAgICAgfSksXG4gICAgICAgIGFuaW1hdGUoNzAwKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCcqID0+IHZvaWQnLCBbXG4gICAgICAgIGFuaW1hdGUoNDAwKSxcbiAgICAgICAgc3R5bGUoe1xuICAgICAgICAgIG9wYWNpdHk6IDBcbiAgICAgICAgfSlcbiAgICAgIF0pXG4gICAgXSlcbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBNZW51Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgcm9vdFVybDogc3RyaW5nO1xuICBhcHBsaWNhdGlvblRpdGxlOiBzdHJpbmc7XG4gIGJhY2tncm91bmRDb2xvcjogc3RyaW5nO1xuICBtZW51TG9hZGluZzogYm9vbGVhbjtcbiAgbWVudUxvYWRpbmdGYWlsOiBib29sZWFuO1xuICBsb2dnZWRJbiQ6IE9ic2VydmFibGU8Ym9vbGVhbj47XG4gIG9ubGluZTogYm9vbGVhbjtcbiAgbWVudU5vdGlmaWNhdGlvbjogc3RyaW5nO1xuICB3YXNPZmZsaW5lOiBib29sZWFuO1xuICBzaG93U2lkZWJhcjogYm9vbGVhbjtcbiAgY29udGV4dFBhdGg6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lbnVTZXJ2aWNlOiBNZW51U2VydmljZSxcbiAgICBwcml2YXRlIHN5c3RlbVN0YXR1c1NlcnZpY2U6IFN5c3RlbVN0YXRlU2VydmljZSkge1xuICAgIHRoaXMucm9vdFVybCA9ICcuLi8uLi8uLi8nO1xuICAgIHRoaXMubWVudUxvYWRpbmcgPSB0cnVlO1xuICAgIHRoaXMubWVudUxvYWRpbmdGYWlsID0gZmFsc2U7XG4gICAgdGhpcy5sb2dnZWRJbiQgPSB0aGlzLnN5c3RlbVN0YXR1c1NlcnZpY2UuZ2V0TG9naW5TdGF0dXMoKTtcbiAgICB0aGlzLm9ubGluZSA9IGZhbHNlO1xuICAgIHRoaXMubWVudU5vdGlmaWNhdGlvbiA9ICcnO1xuICAgIHRoaXMud2FzT2ZmbGluZSA9IHRydWU7XG4gICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSAnI0VDRUNFQyc7XG4gICAgdGhpcy5zaG93U2lkZWJhciA9IGZhbHNlO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5zeXN0ZW1TdGF0dXNTZXJ2aWNlLmNoZWNrT25saW5lU3RhdHVzKCkuc3Vic2NyaWJlKChvbmxpbmVTdGF0dXMpID0+IHtcbiAgICAgIHRoaXMub25saW5lID0gb25saW5lU3RhdHVzO1xuICAgICAgaWYgKHRoaXMub25saW5lICYmIHRoaXMud2FzT2ZmbGluZSkge1xuICAgICAgICB0aGlzLm1lbnVOb3RpZmljYXRpb24gPSAnWW91IGFyZSBvbmxpbmUnO1xuICAgICAgICB0aGlzLndhc09mZmxpbmUgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGlkZSBub3RpZmljYXRpb24gc3RhdHVzIGFmdGVyIHNvbWV0aW1lc1xuICAgICAgICAgKi9cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5tZW51Tm90aWZpY2F0aW9uID0gJyc7XG4gICAgICAgIH0sIDMwMDApO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMb2FkIHN5c3RlbSBzZXR0aW5ncyBpZiBmYWlsZWRcbiAgICAgICAgICovXG4gICAgICAgIGlmICh0aGlzLm1lbnVMb2FkaW5nRmFpbCkge1xuICAgICAgICAgIHRoaXMubWVudUxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKTtcbiAgICAgICAgfVxuXG4gICAgICB9IGVsc2UgaWYgKCF0aGlzLm9ubGluZSkge1xuICAgICAgICB0aGlzLm1lbnVOb3RpZmljYXRpb24gPSAnWW91IGFyZSBvZmZsaW5lJztcbiAgICAgICAgdGhpcy53YXNPZmZsaW5lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmdldFN5c3RlbVNldHRpbmdzKCk7XG4gIH1cblxuICB0b2dnbGVTaWRlQmFyKGUpIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuc2hvd1NpZGViYXIgPSAhdGhpcy5zaG93U2lkZWJhcjtcbiAgfVxuXG4gIGdldFN5c3RlbVNldHRpbmdzKCkge1xuICAgIHRoaXMubWVudVNlcnZpY2UuZ2V0U3lzdGVtU2V0dGluZ3ModGhpcy5yb290VXJsKS5zdWJzY3JpYmUoXG4gICAgICAoc2V0dGluZ3M6IGFueSkgPT4ge1xuICAgICAgICBpZiAoc2V0dGluZ3MpIHtcbiAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uVGl0bGUgPSBzZXR0aW5nc1snYXBwbGljYXRpb25UaXRsZSddO1xuXG4gICAgICAgICAgLy8gZ2V0IHN5c3RlbSBjdXJyZW50IGJhY2tncm91bmQgc3R5bGVcbiAgICAgICAgICBjb25zdCBjb2xvck5hbWUgPSBzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eSgnY3VycmVudFN0eWxlJylcbiAgICAgICAgICAgID8gc2V0dGluZ3NbJ2N1cnJlbnRTdHlsZSddLnNwbGl0KCcvJylbMF1cbiAgICAgICAgICAgIDogc2V0dGluZ3MuaGFzT3duUHJvcGVydHkoJ2tleVN0eWxlJylcbiAgICAgICAgICAgICAgPyBzZXR0aW5nc1sna2V5U3R5bGUnXS5zcGxpdCgnLycpWzBdXG4gICAgICAgICAgICAgIDogJ2JsdWUnO1xuICAgICAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID1cbiAgICAgICAgICAgIE1FTlVfQkFDS0dST1VORF9DT0xPUlNbY29sb3JOYW1lXTtcblxuICAgICAgICAgIHRoaXMuY29udGV4dFBhdGggPSBzZXR0aW5ncy5jb250ZXh0UGF0aCA/IHNldHRpbmdzLmNvbnRleHRQYXRoICsgJy8nIDogJyc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tZW51TG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nRmFpbCA9IGZhbHNlO1xuICAgICAgfSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5tZW51TG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1lbnVMb2FkaW5nRmFpbCA9IHRydWU7XG4gICAgICB9XG4gICAgKTtcbiAgfVxufVxuIl19